# StashApp Telegram Bot Configuration

telegram:
  # Telegram Bot Token от @BotFather
  bot_token: "YOUR_BOT_TOKEN_HERE"

  # Список разрешенных Telegram ID пользователей
  # Узнать свой ID можно через @userinfobot
  allowed_user_ids:
    - 123456789
    - 987654321

  # ID служебного канала для предзагрузки изображений (опционально)
  # Если указан, бот будет предзагружать изображения в этот канал для получения file_id
  # Это ускоряет отправку изображений пользователям
  # Узнать ID канала можно через @userinfobot или @getidsbot
  # Формат: -1001234567890 (для каналов всегда начинается с -100)
  # Если не указан, предзагрузка отключена
  # cache_channel_id: -1001234567890

  # Настройки webhook (опционально)
  # Если включено, бот будет работать в режиме webhook вместо polling.
  # Рекомендуется использовать вместе с reverse proxy/роутером, который терминирует HTTPS.
  webhook:
    enabled: false  # true для webhook, false для polling

    # Полный URL, по которому Telegram будет отправлять обновления.
    # Например, если вы настроили KeenDNS/домен и проксирование:
    #   https://yourdomain.keenetic.pro/webhook
    url: "https://yourdomain.keenetic.pro/webhook"

    # Внутренний порт, на котором бот слушает HTTP внутри контейнера/хоста.
    # Роутер/reverse proxy должен проксировать HTTPS:443 -> этот порт.
    port: 8443

    # Секретный токен для защиты от подделки запросов (опционально, но рекомендуется).
    # Должен быть сконфигурирован как X-Telegram-Bot-Api-Secret-Token на стороне прокси/роутера.
    secret_token: ""

    # Адрес, на котором HTTP-сервер бота слушает внутри контейнера/хоста.
    # 0.0.0.0 означает "слушать на всех интерфейсах".
    listen_address: "0.0.0.0"

stash:
  # URL StashApp GraphQL API
  # Для Docker: http://stash:9999/graphql (если в одной сети)
  # Для локальной установки: http://localhost:9999/graphql
  api_url: "http://stash:9999/graphql"

  # API ключ StashApp (опционально, если требуется авторизация)
  # Оставьте пустым, если не используется
  api_key: ""

  # Логин и пароль для StashApp (если включена авторизация)
  # Оставьте пустым, если авторизация не используется
  username: ""
  password: ""

scheduler:
  # Включить/выключить автоматическую отправку по расписанию
  enabled: true

  # Cron выражение для расписания
  # Формат: минута час день месяц день_недели
  # Примеры:
  #   "0 10 * * *"     - каждый день в 10:00
  #   "0 9,21 * * *"   - каждый день в 9:00 и 21:00
  #   "0 12 * * 1-5"   - с понедельника по пятницу в 12:00
  #   "*/30 * * * *"   - каждые 30 минут
  cron: "0 10 * * *"

  # Временная зона для расписания
  timezone: "Europe/Moscow"

history:
  # Количество дней, в течение которых не повторять отправленные фото
  # Чем больше значение, тем меньше вероятность повторения
  avoid_recent_days: 30

database:
  # Путь к SQLite базе данных
  # Для Docker рекомендуется /data/sent_photos.db
  path: "/data/sent_photos.db"

cache:
  # Минимальный размер кеша (количество изображений с telegram_file_id)
  # Бот будет поддерживать кеш на этом уровне
  min_cache_size: 200

  # Миграция существующих file_id из БД в StashApp при первом запуске
  # Установите в true для переноса данных из БД в StashApp (выполняется один раз)
  migrate_file_ids: false
