# –†–µ–∑—é–º–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –î–∞—Ç–∞: 2026-01-30

## –ü—Ä–æ–±–ª–µ–º–∞
–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –ø–æ–∫–∞–∑–∞–ª –º–µ–¥–ª–µ–Ω–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram**: 4.8-11.9s (58-93% –≤—Ä–µ–º–µ–Ω–∏)
- **–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: 0.8-3.3s (6-40% –≤—Ä–µ–º–µ–Ω–∏)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: 8-13 —Å–µ–∫—É–Ω–¥

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ thumbnail –≤–º–µ—Å—Ç–æ preview

**–§–∞–π–ª—ã**: `bot/stash_client.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ò–∑–º–µ–Ω–µ–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–ª–∞—Å—Å–µ `StashImage` (—Å—Ç—Ä–æ–∫–∞ 28-30)
  - **–ë—ã–ª–æ**: `preview` ‚Üí `image`
  - **–°—Ç–∞–ª–æ**: `thumbnail` ‚Üí `preview` ‚Üí `image`
- –î–æ–±–∞–≤–ª–µ–Ω `thumbnail` –≤ GraphQL –∑–∞–ø—Ä–æ—Å `FindRandomImage` (—Å—Ç—Ä–æ–∫–∞ 162-184)

**–≠—Ñ—Ñ–µ–∫—Ç**: –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ 3-5 —Ä–∞–∑, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏.

### 2. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–§–∞–π–ª—ã**: `bot/telegram_handler.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `asyncio` (—Å—Ç—Ä–æ–∫–∞ 3)
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –≤ `__init__` (—Å—Ç—Ä–æ–∫–∏ 49-50):
  - `_prefetched_image`: –∫—ç—à –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  - `_prefetch_lock`: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ `_prefetch_next_image()` –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 221-271)
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `_send_random_photo()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 80-92)
- –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 183-186)

**–≠—Ñ—Ñ–µ–∫—Ç**: –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã `/random` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞.

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|------|-------|-----------|
| –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å /random | 8-13s | 2-4s | **3-4x –±—ã—Å—Ç—Ä–µ–µ** |
| –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ /random | 8-13s | ~1s | **8-13x –±—ã—Å—Ç—Ä–µ–µ** |
| –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ | 8-13s | 2-4s | **3-4x –±—ã—Å—Ç—Ä–µ–µ** |

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞

```
–ö–æ–º–∞–Ω–¥–∞ /random
    ‚Üì
–ï—Å—Ç—å –∫—ç—à? ‚Üí –î–ê ‚Üí –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (~1s)
    ‚Üì –ù–ï–¢
–ó–∞–≥—Ä—É–∑–∏—Ç—å thumbnail (~2-4s)
    ‚Üì
–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram
    ‚Üì
–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—É—é –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É
    ‚Üì
–°–ª–µ–¥—É—é—â–∏–π /random –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä—ã–º
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python -m bot.main` –∏–ª–∏ `docker-compose up`
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/random`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Performance Report)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/random` –µ—â–µ —Ä–∞–∑ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏
5. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –ø–æ–º–µ—Ç–∫–∞ `(–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞)`

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

–ò—â–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
- `‚ö° –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ` - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞
- `üîÑ –ó–∞–ø—É—â–µ–Ω–∞ —Ñ–æ–Ω–æ–≤–∞—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞` - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞
- `‚úÖ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ` - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `Performance Report: Send random photo` - –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `/random` (–Ω–µ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞)
- Thumbnail –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ Telegram
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ thumbnail –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è preview –∏–ª–∏ –ø–æ–ª–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ—Ç–∞
