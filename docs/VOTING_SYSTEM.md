# Photo Voting System - Implementation Summary

## Overview
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –¥–ª—è Telegram –±–æ—Ç–∞ StashApp —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- üëç/üëé –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ –∫–∞–∂–¥—ã–º —Ñ–æ—Ç–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ StashApp
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–∞–º –∏ –≥–∞–ª–µ—Ä–µ—è–º
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–æ–ª–æ—Å–æ–≤

## –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`bot/database.py`)

#### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- **`votes`** - —Ö—Ä–∞–Ω–∏—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≥–æ–ª–æ—Å–∞ –∑–∞ —Ñ–æ—Ç–æ
- **`performer_preferences`** - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–∞–º
- **`gallery_preferences`** - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–∞–ª–µ—Ä–µ—è–º

#### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `add_vote()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞
- `get_vote()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞ –∑–∞ —Ñ–æ—Ç–æ
- `update_performer_preference()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–∞
- `update_gallery_preference()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–∏
- `mark_gallery_rating_set()` - –æ—Ç–º–µ—Ç–∫–∞ –æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Ä–µ–π—Ç–∏–Ω–≥–µ –≥–∞–ª–µ—Ä–µ–∏
- `get_performer_preferences()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
- `get_gallery_preferences()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–π
- `get_blacklisted_performers()` - –ø–æ–ª—É—á–µ–Ω–∏–µ blacklist –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
- `get_blacklisted_galleries()` - –ø–æ–ª—É—á–µ–Ω–∏–µ blacklist –≥–∞–ª–µ—Ä–µ–π
- `get_whitelisted_performers()` - –ø–æ–ª—É—á–µ–Ω–∏–µ whitelist –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
- `get_whitelisted_galleries()` - –ø–æ–ª—É—á–µ–Ω–∏–µ whitelist –≥–∞–ª–µ—Ä–µ–π
- `get_gallery_preference()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥–∞–ª–µ—Ä–µ–∏

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ StashClient (`bot/stash_client.py`)

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è StashImage –∫–ª–∞—Å—Å–∞:
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `gallery_id` - ID –ø–µ—Ä–≤–æ–π –≥–∞–ª–µ—Ä–µ–∏ —Ñ–æ—Ç–æ
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `gallery_title` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `performers` - —Å–ø–∏—Å–æ–∫ –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤ (id –∏ name)

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ GraphQL –∑–∞–ø—Ä–æ—Å—ã:
- –ó–∞–ø—Ä–æ—Å `findImages` —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç `galleries` –∏ `performers`

#### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `update_image_rating(image_id, rating)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ —Ñ–æ—Ç–æ (1-5)
- `update_gallery_rating(gallery_id, rating)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –≥–∞–ª–µ—Ä–µ–∏ (1-5)
- `get_random_image_weighted()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Ñ–æ—Ç–æ —Å —É—á–µ—Ç–æ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

### 3. –ù–æ–≤—ã–π –º–æ–¥—É–ª—å VotingManager (`bot/voting.py`)

–ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–π –ª–æ–≥–∏–∫–æ–π –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `process_vote(image, vote)` - –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–∞:
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ —Ñ–æ—Ç–æ –≤ Stash (5 –¥–ª—è üëç, 1 –¥–ª—è üëé)
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞ –≤ –ë–î
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–∏
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ –≥–∞–ª–µ—Ä–µ–∏ –ø–æ—Å–ª–µ 5+ –≥–æ–ª–æ—Å–æ–≤

- `get_preferences_summary()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø-5 –ª—é–±–∏–º—ã—Ö/–Ω–µ–ª—é–±–∏–º—ã—Ö –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤ –∏ –≥–∞–ª–µ—Ä–µ–π

- `get_filtering_lists()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (blacklist/whitelist)

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è TelegramHandler (`bot/telegram_handler.py`)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `_send_random_photo()`:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `get_random_image_weighted()` –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞
- –î–æ–±–∞–≤–ª–µ–Ω—ã inline-–∫–Ω–æ–ø–∫–∏ üëç/üëé –∫ –∫–∞–∂–¥–æ–º—É —Ñ–æ—Ç–æ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤

#### –ù–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫:
- `handle_vote_callback()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–∞ —á–µ—Ä–µ–∑ VotingManager
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –∫–Ω–æ–ø–æ–∫ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–æ—á–∫–∏)
  - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

#### –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞:
- `/preferences` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π:
  - –¢–æ–ø-5 –ª—é–±–∏–º—ã—Ö –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
  - –¢–æ–ø-5 –Ω–µ–ª—é–±–∏–º—ã—Ö –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
  - –¢–æ–ø-5 –ª—é–±–∏–º—ã—Ö –≥–∞–ª–µ—Ä–µ–π
  - –¢–æ–ø-5 –Ω–µ–ª—é–±–∏–º—ã—Ö –≥–∞–ª–µ—Ä–µ–π
  - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–∞—Ö:
- `/start` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–∞–Ω–¥–µ `/preferences`
- `/help` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ main.py (`bot/main.py`)

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `VotingManager` –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î –∏ StashClient
- –ü–µ—Ä–µ–¥–∞—á–∞ `VotingManager` –≤ `TelegramHandler`
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ callback –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–æ—Ü–µ—Å—Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ñ–æ—Ç–æ** ‚Üí –ø–æ–¥ –Ω–∏–º –∫–Ω–æ–ø–∫–∏ üëç/üëé

2. **–ù–∞–∂–∞—Ç–∏–µ üëç (–ª–∞–π–∫)**:
   - –†–µ–π—Ç–∏–Ω–≥ —Ñ–æ—Ç–æ –≤ Stash ‚Üí 5/5 (100/100)
   - –ì–æ–ª–æ—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (–≥–∞–ª–µ—Ä–µ—è, –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä—ã)
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–∞: `positive_votes++`, `score` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
   - –î–ª—è –≥–∞–ª–µ—Ä–µ–∏: `positive_votes++`, `score` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
   - –ï—Å–ª–∏ –≤ –≥–∞–ª–µ—Ä–µ–µ >= 5 –≥–æ–ª–æ—Å–æ–≤ ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ Stash

3. **–ù–∞–∂–∞—Ç–∏–µ üëé (–¥–∏–∑–ª–∞–π–∫)**:
   - –†–µ–π—Ç–∏–Ω–≥ —Ñ–æ—Ç–æ –≤ Stash ‚Üí 1/5 (20/100)
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –Ω–æ `negative_votes++`

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:

**Score —Ñ–æ—Ä–º—É–ª–∞**: `(positive_votes - negative_votes) / total_votes`

**Blacklist** (score < 0):
- –ü–µ—Ä—Ñ–æ—Ä–º–µ—Ä—ã –∏ –≥–∞–ª–µ—Ä–µ–∏ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º score
- –ò—Ö –∫–æ–Ω—Ç–µ–Ω—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è** –∏–∑ –≤—ã–¥–∞—á–∏

**Whitelist** (score > 0):
- –ü–µ—Ä—Ñ–æ—Ä–º–µ—Ä—ã –∏ –≥–∞–ª–µ—Ä–µ–∏ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º score
- –ò—Ö –∫–æ–Ω—Ç–µ–Ω—Ç **–ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è**
- –ï—Å–ª–∏ –µ—Å—Ç—å whitelist, –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –∏–∑ –Ω–µ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 50%

### –†–µ–π—Ç–∏–Ω–≥ –≥–∞–ª–µ—Ä–µ–∏:

–ü–æ—Å–ª–µ 5+ –≥–æ–ª–æ—Å–æ–≤ –∑–∞ —Ñ–æ—Ç–æ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏:
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ä–µ–π—Ç–∏–Ω–≥ 1-5:
  - 0-20% –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö ‚Üí 1 –∑–≤–µ–∑–¥–∞
  - 20-40% ‚Üí 2 –∑–≤–µ–∑–¥—ã
  - 40-60% ‚Üí 3 –∑–≤–µ–∑–¥—ã
  - 60-80% ‚Üí 4 –∑–≤–µ–∑–¥—ã
  - 80-100% ‚Üí 5 –∑–≤–µ–∑–¥
- –†–µ–π—Ç–∏–Ω–≥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ Stash **–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ**
- –§–ª–∞–≥ `rating_set` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `/start`
2. –ü–æ–ª—É—á–∏—Ç–µ —Ñ–æ—Ç–æ: `/random`
3. –û—Ü–µ–Ω–∏—Ç–µ –∫–Ω–æ–ø–∫–∞–º–∏ üëç –∏–ª–∏ üëé
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è: `/preferences`
5. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å - —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —É—á–∏—Ç—å—Å—è!

### –ö–æ–º–∞–Ω–¥—ã:

- `/random` - –ø–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ —Ñ–æ—Ç–æ (—Å —É—á–µ—Ç–æ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π)
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
- `/preferences` - –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è (—Ç–æ–ø—ã –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤/–≥–∞–ª–µ—Ä–µ–π)
- `/help` - —Å–ø—Ä–∞–≤–∫–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ vs. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è:
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã **–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è** - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞ –¥–µ–ª—è—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã—Ö:
- –ï—Å–ª–∏ –Ω–µ—Ç –≥–∞–ª–µ—Ä–µ–∏ ‚Üí –≥–æ–ª–æ—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤
- –ï—Å–ª–∏ –Ω–µ—Ç –ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–æ–≤ ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≥–∞–ª–µ—Ä–µ—è
- –ï—Å–ª–∏ –Ω–µ—Ç –Ω–∏ —Ç–æ–≥–æ, –Ω–∏ –¥—Ä—É–≥–æ–≥–æ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–æ—Ç–æ

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –≤ `_last_sent_images` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–∞ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ Stash API.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º —Å–±–æ–µ

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ - –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ `CREATE TABLE IF NOT EXISTS`. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞—é—Ç.

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã –≥–æ–ª–æ—Å–∞
2. –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≤ —Ñ–∞–π–ª
3. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (ML-–ø–æ–¥—Ö–æ–¥)
5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–≥–∞–º
6. –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚úÖ `bot/database.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –∏ –º–µ—Ç–æ–¥—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- ‚úÖ `bot/stash_client.py` - —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–∞–ª–µ—Ä–µ—è–º–∏/–ø–µ—Ä—Ñ–æ—Ä–º–µ—Ä–∞–º–∏
- ‚úÖ `bot/voting.py` - **–Ω–æ–≤—ã–π —Ñ–∞–π–ª** —Å –ª–æ–≥–∏–∫–æ–π –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- ‚úÖ `bot/telegram_handler.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- ‚úÖ `bot/main.py` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è VotingManager

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫. Linter –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ.
