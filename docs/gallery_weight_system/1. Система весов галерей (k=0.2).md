# 1. –°–∏—Å—Ç–µ–º–∞ –≤–µ—Å–æ–≤ –≥–∞–ª–µ—Ä–µ–π (k=0.2)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (Core —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –≤–µ—Å–æ–≤ –¥–ª—è –≥–∞–ª–µ—Ä–µ–π —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º k=0.2. –í–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –≥–∞–ª–µ—Ä–µ–π.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ MVP
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k = 0.2
- –ó–∞ "+": –≤–µ—Å = –≤–µ—Å √ó 1.2
- –ó–∞ "-": –≤–µ—Å = –≤–µ—Å √ó 0.8
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 0.1 ‚â§ –≤–µ—Å ‚â§ 10.0
- –ù–∞—á–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞: —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ü–µ–Ω–æ–∫ –ø–æ —Ñ–æ—Ä–º—É–ª–µ: W = 1.0 * 1.2^(–ø–ª—é—Å—ã) * 0.8^(–º–∏–Ω—É—Å—ã)

## –ó–∞–¥–∞—á–∏

### 1.1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î
**–§–∞–π–ª:** `bot/database.py`

–î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É `gallery_preferences`:
- `weight REAL DEFAULT 1.0` - –≤–µ—Å –≥–∞–ª–µ—Ä–µ–∏
- `excluded BOOLEAN DEFAULT FALSE` - —Ñ–ª–∞–≥ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ —Ä–æ—Ç–∞—Ü–∏–∏
- `excluded_at TIMESTAMP` - –¥–∞—Ç–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `threshold_notification_shown BOOLEAN DEFAULT FALSE` - —Ñ–ª–∞–≥ –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Ä–æ–≥–µ

–°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ `weight` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã–±–æ—Ä–∫–∏.

### 1.2. –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –≤–µ—Å–∞–º–∏
**–§–∞–π–ª:** `bot/database.py`

–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã:
- `update_gallery_weight(gallery_id, vote)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–∞ —Å —É—á–µ—Ç–æ–º k=0.2
- `get_gallery_weight(gallery_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Å–∞ –≥–∞–ª–µ—Ä–µ–∏
- `get_all_gallery_weights()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–µ—Å–æ–≤ (–¥–ª—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞)
- `calculate_initial_weight(positive_votes, negative_votes)` ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –≤–µ—Å–æ–≤; –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –±–æ—Ç–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

### 1.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ VotingManager
**–§–∞–π–ª:** `bot/voting.py`

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `process_vote()`:
- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–∏ –≤—ã–∑—ã–≤–∞—Ç—å `database.update_gallery_weight()`
- –ü—Ä–∏–º–µ–Ω—è—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è 0.1 ‚â§ –≤–µ—Å ‚â§ 10.0

### 1.4. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
**–§–∞–π–ª:** `bot/database.py`

–í `_init_database()` –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `weight`:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `weight = 1.0` –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ `gallery_preferences`
- –≠—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —Å–∫—Ä–∏–ø—Ç–æ–º –∏–∑ –∑–∞–¥–∞—á–∏ 14

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–∞ –ø—Ä–∏ "+" (√ó1.2)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–∞ –ø—Ä–∏ "-" (√ó0.8)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–Ω–µ –Ω–∏–∂–µ 0.1, –Ω–µ –≤—ã—à–µ 10.0)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã—Ö –≤–µ—Å–æ–≤ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ù–µ—Ç (–±–∞–∑–æ–≤–∞—è –∑–∞–¥–∞—á–∞)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–µ–ª–∏–∑–∞

### ‚úÖ –ú–æ–∂–Ω–æ —Ä–µ–ª–∏–∑–∏—Ç—å –ø–æ—Å–ª–µ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏

**–£—Å–ª–æ–≤–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–µ–ª–∏–∑–∞:**
1. –í—Å–µ –Ω–æ–≤—ã–µ –ø–æ–ª—è –ë–î –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`DEFAULT`)
2. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
3. –°–∏—Å—Ç–µ–º–∞ –≤–µ—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∑–∞–¥–∞—á–∞ 3)
4. –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ, –≤–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

**Fallback-–º–µ—Ö–∞–Ω–∏–∑–º—ã:**
- –ï—Å–ª–∏ `voting_manager` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- –í–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `voting_manager`
- –°—Ç–∞—Ä—ã–π –∫–æ–¥ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º:**
- [ ] –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (üëç/üëé)
- [ ] –í–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î)
- [ ] –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `gallery_preferences` –∏–º–µ—é—Ç `weight = 1.0`
- [ ] –ù–æ–≤—ã–µ –≥–∞–ª–µ—Ä–µ–∏ –ø–æ–ª—É—á–∞—é—Ç `weight = 1.0` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ß—Ç–æ –ù–ï —Å–ª–æ–º–∞–µ—Ç—Å—è:**
- –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ –¥–æ –∑–∞–¥–∞—á–∏ 3)
- –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –ó–∞–¥–∞—á–∞ 2: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–∞–ª–µ—Ä–µ–∏
- –ó–∞–¥–∞—á–∞ 3: –í–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –≥–∞–ª–µ—Ä–µ–∏
- –ó–∞–¥–∞—á–∞ 14: –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –≤–µ—Å–æ–≤ (–ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏)
